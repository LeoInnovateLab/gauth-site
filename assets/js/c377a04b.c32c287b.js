"use strict";(self.webpackChunkgauth_site=self.webpackChunkgauth_site||[]).push([[742],{4838:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var r=n(4848),o=n(8453);const i={sidebar_position:1},a="Introduction",s={id:"index",title:"Introduction",description:"\u26a1\ufe0f GAuth can help simplify the authorization login process for third-party platforms.",source:"@site/docs/index.md",sourceDirName:".",slug:"/",permalink:"/docs/",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",next:{title:"Github Authorization",permalink:"/docs/Integrations/github"}},l={},u=[{value:"Currently Supported",id:"currently-supported",level:2},{value:"Installation",id:"installation",level:2},{value:"Step",id:"step",level:2},{value:"Demo",id:"demo",level:2}];function c(t){const e={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(e.p,{children:"\u26a1\ufe0f GAuth can help simplify the authorization login process for third-party platforms."}),"\n",(0,r.jsx)(e.h2,{id:"currently-supported",children:"Currently Supported"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docs.github.com/en/apps/oauth-apps/building-oauth-apps/authorizing-oauth-apps",children:"Github OAuth"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://developers.google.com/identity/protocols/oauth2",children:"Google OAuth"})}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-shell",children:"go get github.com/LeoInnovateLab/gauth\n"})}),"\n",(0,r.jsx)(e.h2,{id:"step",children:"Step"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["Register as a developer account for third-party platforms, such as: ",(0,r.jsx)(e.a,{href:"https://github.com/settings/developers",children:"GitHub developer account"}),"."]}),"\n",(0,r.jsxs)(e.li,{children:["Create an application for the third-party platform and obtain configuration information.","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"Client Id"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"Client Secrets"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.code,{children:"Callback URL"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"Utilize GAuth for authorization login."}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'// create authorization request\nauthRequest, err := gauth.New().\n\t\tSource("github").\n\t\tClientId("your_client_id").\n\t\tClientSecret("your_client_secret").\n\t\tRedirectUrl("http://localhost:8080/auth/github/callback").\n\t\tBuild()\n\n// generate authorization URL\t\t\nauthorizeUrl, err := authRequest.Authorize("state")\n\n// After authorization login, it will return login information.\nresponse, err := authRequest.Login(callback)\n'})}),"\n",(0,r.jsx)(e.h2,{id:"demo",children:"Demo"}),"\n",(0,r.jsx)(e.p,{children:"main.go"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n\t"encoding/json"\n\t"fmt"\n\t"github.com/LeoInnovateLab/gauth"\n\t_ "github.com/LeoInnovateLab/gauth/register"\n\t"github.com/LeoInnovateLab/gauth/utils"\n\t"github.com/gorilla/schema"\n\t"github.com/joho/godotenv"\n\t"log"\n\t"net/http"\n\t"os"\n)\n\nvar authRequestMap = make(map[string]gauth.AuthRequest)\n\nfunc main() {\n\terr := godotenv.Load(".env.local")\n\tif err != nil {\n\t\tlog.Fatalf("Error loading .env file %v", err)\n\t}\n\n\tport := 8080\n\n\thttp.HandleFunc("GET /auth/{source}/login", login)\n\thttp.HandleFunc("GET /auth/{source}/callback", callback)\n\n\terr = http.ListenAndServe(fmt.Sprintf(":%d", port), nil)\n\tif err != nil {\n\t\tlog.Printf("Failed to start server:%v", err)\n\t\treturn\n\t}\n}\n\nfunc pickAuthRequest(source string) gauth.AuthRequest {\n\tif authRequest, ok := authRequestMap[source]; ok {\n\t\treturn authRequest\n\t}\n\n\tvar clientId, secret string\n\n\tswitch source {\n\tcase "github":\n\t\tclientId = os.Getenv("GITHUB_CLIENT_ID")\n\t\tsecret = os.Getenv("GITHUB_SECRET")\n\t\tbreak\n\tcase "google":\n\t\tclientId = os.Getenv("GOOGLE_CLIENT_ID")\n\t\tsecret = os.Getenv("GOOGLE_SECRET")\n\t\tbreak\n\t}\n\n\tauthRequest, err := gauth.New().\n\t\tSource(source).\n\t\tClientId(clientId).\n\t\tClientSecret(secret).\n\t\tRedirectUrl(fmt.Sprintf("http://localhost:8080/auth/%s/callback", source)).\n\t\tBuild()\n\n\tif err != nil {\n\t\tlog.Fatalf("Failed to build request:%v", err)\n\t}\n\n\tauthRequestMap[source] = authRequest\n\n\treturn authRequest\n}\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n\tsource := r.PathValue("source")\n\tauthRequest := pickAuthRequest(source)\n\tauthorizeUrl, err := authRequest.Authorize(utils.CreateState())\n\tif err != nil {\n\t\tlog.Printf("Failed to authorize:%v", err)\n\t\thttp.Error(w, "Failed to authorize", http.StatusInternalServerError)\n\t\treturn\n\t}\n\n\thttp.Redirect(w, r, authorizeUrl, http.StatusMovedPermanently)\n}\n\nfunc callback(w http.ResponseWriter, r *http.Request) {\n\tsource := r.PathValue("source")\n\tauthRequest := pickAuthRequest(source)\n\n\tvar c gauth.AuthCallback\n\n\tdecoder := schema.NewDecoder()\n\tdecoder.IgnoreUnknownKeys(true)\n\terr := decoder.Decode(&c, r.URL.Query())\n\tif err != nil {\n\t\tlog.Printf("Failed to decode request body:%v", err)\n\t\thttp.Error(w, "Failed to decode request body", http.StatusBadRequest)\n\t\treturn\n\t}\n\n\tresponse, err := authRequest.Login(c)\n\tvar jsonByte []byte\n\tif err != nil {\n\t\tlog.Printf("Failed to login:%v", err)\n\t\tjsonByte, _ = json.Marshal(err)\n\t\thttp.Error(w, string(jsonByte), http.StatusBadRequest)\n\t\treturn\n\t} else {\n\t\tjsonByte, _ = json.Marshal(response)\n\t}\n\tw.Header().Set("Content-Type", "application/json")\n\tw.Write(jsonByte)\n}\n\n'})}),"\n",(0,r.jsx)(e.p,{children:".env.local"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-env",children:"GITHUB_CLIENT_ID=your_github_client_id\nGITHUB_SECRET=your_github_secret\n\nGOOGLE_CLIENT_ID=your_google_client_id\nGOOGLE_SECRET=your_google_secret\n"})})]})}function h(t={}){const{wrapper:e}={...(0,o.R)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(c,{...t})}):c(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>a,x:()=>s});var r=n(6540);const o={},i=r.createContext(o);function a(t){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function s(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(o):t.components||o:a(t.components),r.createElement(i.Provider,{value:e},t.children)}}}]);